<div class="page-header">
  <%= link_to new_station_path, :class => 'btn btn-primary' do %>
    <span class="glyphicon glyphicon-plus"></span>
    New Station
  <% end %>
  <h1>Listing stations</h1>
</div>

<div class="table-responsive">
  <table class="table table-striped table-bordered table-hover">
    <thead>
    <tr>
      <th>Name</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Current Weather</th>
      <th>Most Recent Reading</th>
      <th>Flow Rate</th>

      <th></th>
      <th></th>
      <th></th>
    </tr>
    </thead>
    <tbody>
    <%= content_tag_for(:tr, @stations) do |station| %>
      <div dom_id(station)>
        <td><%= link_to station.name, station %></td>
        <td><%= fmt_coord station.latitude.to_f %></td>
        <td><%= fmt_coord station.longitude.to_f %></td>
        <td><%= number_with_precision(station.current_temp, precision: 2)  %>&deg; F <br/>
          <%= station.current_summary  %>
        </td>
        <% if @station != nil %>
          <td><%= station.flow_readings.last.date_time.in_time_zone.strftime("%A %e %B %Y,%I:%M:%S %Z") %></td>
          <td><%= format_flow_rate station.flow_readings.last.flow_rate %></td>
          <% unless station.favorite?(current_user) %>
            <td><%= button_to 'Claim River', claim_station_path(station) %></td>
          <% end %>
        <% end %>
      </div>
    <% end %>
    </tbody>
  </table>
</div>
